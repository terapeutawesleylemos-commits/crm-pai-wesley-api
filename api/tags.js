import db from '../lib/db.js'; import { requireAuth } from './_auth.js'; export default async function handler(req,res){ const user=requireAuth(req,res); if(!user) return res.status(401).end(); if(req.method==='GET'){ const q=await db.query('select id,name from tags order by name'); return res.json(q.rows); } if(req.method==='POST'){ const {name}=req.body||{}; if(!name) return res.status(400).json({error:'nome obrigat√≥rio'}); await db.query('insert into tags(name) values ($1) on conflict(name) do nothing',[name]); return res.json({ok:true}); } return res.status(405).end(); }