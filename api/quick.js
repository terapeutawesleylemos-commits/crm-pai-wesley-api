import db from '../lib/db.js'; import { requireAuth } from './_auth.js'; export default async function handler(req,res){ const user=requireAuth(req,res); if(!user) return res.status(401).end(); if(req.method==='GET'){ const q=await db.query('select id,key,text from quick_replies order by key'); return res.json(q.rows); } if(req.method==='POST'){ const {key,text}=req.body||{}; if(!key||!text) return res.status(400).json({error:'key e text obrigat√≥rios'}); await db.query('insert into quick_replies(key,text) values ($1,$2) on conflict(key) do update set text=excluded.text',[key,text]); return res.json({ok:true}); } return res.status(405).end(); }